{"version":3,"sources":["constant.ts","utils/react.ts","store/types.ts","store/dm.ts","store/collection.ts","utils/ability.ts","store/character.ts","store/index.ts","utils/entity.ts","utils/spell.ts","components/Spell.tsx","utils/feat.ts","components/Feat.tsx","components/QuickSearch.tsx","components/QuickSearchToggler.tsx","components/NavLink.tsx","components/Navbar.tsx","components/AbilityIcon.tsx","components/StatNumber.tsx","components/AbilityInput.tsx","components/CollectionEntitySelect.tsx","components/Select.tsx","components/Player/CharacterBasic.tsx","components/SkillInput.tsx","components/Player/CharacterSkills.tsx","components/CollectionEntityPicker.tsx","components/Player/CharacterSpellbook.tsx","pages/PlayerPage.tsx","utils/misc.ts","components/DM/CharacterTracker.tsx","components/DM/Character.tsx","components/ButtonSwitch.tsx","pages/DMPage.tsx","App.tsx","serviceWorkerRegistration.ts","index.tsx"],"names":["ENTITY_COLORS","spell","feat","weapon","createContextNoNullCheck","defaults","context","createContext","c","useContext","Error","useIsSmallerScreen","useMediaQuery","CONTAINER_WIDTH","AbilityType","DEFAULT_CHARACTER_PROPS","hp","maxHP","attunement","initiative","perception","willSave","senseMotive","rolledInitiative","rolledPerception","rolledSenseMotive","rolledWillSave","trackers","DMStore","characters","makeObservable","this","rollAllInitiative","action","rollAllPerception","rollAllSenseMotive","rollAllWillSave","healAll","addTracker","recoverTracker","recoverAllTracker","recoverAllAttunment","sortedCharacters","computed","observable","array","sort","a","b","ac","parseInt","name","push","id","shortid","getNonConflictName","cloneDeep","remove","Math","ceil","random","forEach","rollInitiative","rollPerception","rollSenseMotive","rollWillSave","remain","max","t","existed","filter","startsWith","length","s","JSON","parse","map","Collection","type","data","options","fuse","Fuse","includeScore","threshold","keys","searchFields","find","collections","skill","SKILL_DATA","race","RACE_DATA","SPELL_DATA","FEAT_DATA","class","CLASS_DATA","ABILITY_TYPES","str","dex","con","int","wis","cha","abilityTranslates","getModifierFromScore","score","floor","showModifier","mod","ABILITY_COST","7","8","9","10","11","12","13","14","15","16","17","18","getScoreCost","Character","baseAbility","bonusAbilityType","level","raceId","classId","skillRanks","spellbookIds","abilityModifier","abilityCost","bonusAbility","setRace","spellbook","generate","Map","deep","set","Set","getById","ability","hd","classSkills","base","bonus","addBonusScores","ab","mapValues","Object","values","v","reduce","acc","isEmpty","includes","rank","get","modifier","isClassSkill","classBonus","total","Array","from","Boolean","stringify","pick","serializableProps","json","useCurrentCharacter","CurrentCharacterContext","Store","dm","restore","persist","key","limitEach","search","limit","autorun","entries","k","replace","parseCharacters","useStore","StoreContext","entityTypeTranslates","translates","school","domain","castingTime","components","range","effect","target","area","aiming","duration","saving","resistance","SpellMeta","size","mt","meta","pl","color","width","spellTranslates","Spell","showName","showMeta","showDescription","className","direction","align","book","toUpperCase","as","fontSize","style","fontWeight","pt","whiteSpace","dangerouslySetInnerHTML","__html","description","featTranslates","requirement","benefit","normal","special","FeatMeta","Feat","showBrief","fontStyle","brief","QuickSearchResultItem","item","el","mb","border","borderColor","p","borderRadius","_hover","boxShadow","transition","QuickSearch","store","useState","searchKey","setSearchKey","searchResult","useMemo","quickSearch","currentType","setCurrentType","isSmallerScreen","resultType","results","useEffect","hasResult","flexGrow","flexShrink","Search2","placeholder","autoFocus","value","onChange","e","matchWidth","autoSelect","Button","rightIcon","ChevronDown","variant","colorScheme","onClick","r","bgColor","cursor","opacity","overflowY","QuickSearchToggler","children","useDisclosure","isOpen","onClose","onOpen","d","flexDir","NavLink","to","props","match","useRouteMatch","RouterLink","Navbar","bg","borderBottom","py","alignItems","mr","GiAncientSword","h","w","aria-label","icon","icons","GiFist","GiBullseye","GiShield","GiBrain","GiAerialSignal","GiFlyingFlag","AbilityIcon","StatNumber","number","text","spacing","textAlign","lineHeight","AbilityInput","min","racial","isIncreaseDisabled","fontFamily","isAttached","isDisabled","CollectionEntitySelect","collection","placement","FaCheck","undefined","Select","o","i","CharacterBasic","character","maxW","remainPoints","my","resetBaseAbility","SkillInput","FaStar","disabled","CharacterSkills","getSkillDetail","CollectionEntityPicker","inputRef","onPick","items","FaSearch","ref","borderTop","maxH","overflow","picked","background","CharacterSpellbook","initialFocusRef","useRef","showSpell","setShowSpell","add","columns","Delete","confirm","delete","stopPropagation","NAV_LINKS","url","PlayerPage","currentCharacter","showMenuNav","currentMenuNavItem","setCurrentMenuNavItem","location","useLocation","history","useHistory","navLink","pathname","Provider","display","justifyContent","n","borderRight","path","component","stringToColor","hash","charCodeAt","toString","substr","Tracker","tracker","px","CharacterTracker","isLazy","borderBottomColor","borderTopWidth","borderTopColor","borderTopRadius","flexBasis","justify","heal","removeCharacter","ButtonSwitch","DMPage","order","setOrder","wrap","addCharacter","IconButton","App","basename","isLocalhost","window","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","onUpdate","onSuccess","catch","error","configure","enforceActions","theme","extendTheme","Container","baseStyle","init","ReactDOM","render","StrictMode","document","getElementById","refreshing","URL","process","href","origin","addEventListener","fetch","headers","response","contentType","status","indexOf","ready","unregister","reload","checkValidServiceWorker","serviceWorkerRegistration","waiting","postMessage"],"mappings":"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","file":"static/js/main.12bcf6cf.chunk.js","sourcesContent":["export const CONTAINER_WIDTH = 1024;\n\nexport const ENTITY_COLORS: Record<string, string> = {\n  spell: 'purple.600',\n  feat: 'red.600',\n  weapon: 'orange.600',\n};\n","import { createContext, useContext } from 'react';\nimport { useMediaQuery } from '@chakra-ui/react';\n\nimport { CONTAINER_WIDTH } from '../constant';\n\nexport function createContextNoNullCheck<T>(defaults?: T): [() => T, React.Context<T | undefined>] {\n  const context = createContext<T | undefined>(defaults);\n\n  function use(): T {\n    const c = useContext(context);\n\n    if (typeof c === 'undefined') {\n      throw new Error('useContext must be inside a Provider with a value');\n    }\n\n    return c;\n  }\n\n  return [use, context];\n}\n\nexport function useIsSmallerScreen(): boolean {\n  return useMediaQuery(`(max-width: ${CONTAINER_WIDTH - 1}px)`)[0];\n}\n","export enum AbilityType {\n  str = 'str',\n  dex = 'dex',\n  con = 'con',\n  int = 'int',\n  wis = 'wis',\n  cha = 'cha',\n}\n\nexport interface Abilities {\n  [AbilityType.str]: number;\n  [AbilityType.dex]: number;\n  [AbilityType.con]: number;\n  [AbilityType.int]: number;\n  [AbilityType.wis]: number;\n  [AbilityType.cha]: number;\n}\n\nexport interface Entity {\n  id: string;\n  name: string;\n}\n\nexport interface Skill extends Entity {\n  ability: AbilityType;\n  category?: boolean;\n  subs?: Array<Entity>;\n}\n\nexport interface Race extends Entity {\n  ability: Partial<Abilities>;\n}\n\nexport interface Class extends Entity {\n  hd: number;\n  classSkills: Array<string>;\n}\n\nexport interface SpellMeta {\n  school?: string;\n  level?: string;\n  castingTime?: string;\n  components?: string;\n  effect?: string;\n  area?: string;\n  target?: string;\n  aiming?: string;\n  duration?: string;\n  saving?: string;\n  resistance?: string;\n}\n\nexport interface Spell extends Entity {\n  meta: SpellMeta;\n  book: string;\n  description: string;\n}\n\nexport interface FeatMeta {\n  requirement?: string;\n  benefit?: string;\n  special?: string;\n  normal?: string;\n}\n\nexport interface Feat extends Entity {\n  meta: FeatMeta;\n  book: string;\n  brief: string;\n  description?: string;\n}\n\nexport type Weapon = Entity;\n","import { cloneDeep } from 'lodash';\nimport { observable, IObservableArray, makeObservable, action, computed } from 'mobx';\nimport shortid from 'shortid';\n\nexport interface Tracker {\n  id: string;\n  name: string;\n  remain: number;\n  max: string;\n}\n\nexport interface DMCharacter {\n  id: string;\n  name: string;\n  hp: string;\n  maxHP: string;\n  attunement: string;\n  initiative: string;\n  perception: string;\n  senseMotive: string;\n  willSave: string;\n  rolledInitiative: number;\n  rolledPerception: number;\n  rolledSenseMotive: number;\n  rolledWillSave: number;\n  trackers: Array<Tracker>;\n}\n\nconst DEFAULT_CHARACTER_PROPS = {\n  hp: '1',\n  maxHP: '10',\n  attunement: '0',\n  initiative: '0',\n  perception: '0',\n  willSave: '0',\n  senseMotive: '0',\n  rolledInitiative: 0,\n  rolledPerception: 0,\n  rolledSenseMotive: 0,\n  rolledWillSave: 0,\n  trackers: [],\n};\n\nexport default class DMStore {\n  characters: IObservableArray<DMCharacter>;\n\n  constructor() {\n    makeObservable(this, {\n      rollAllInitiative: action,\n      rollAllPerception: action,\n      rollAllSenseMotive: action,\n      rollAllWillSave: action,\n\n      healAll: action,\n\n      addTracker: action,\n      recoverTracker: action,\n      recoverAllTracker: action,\n      recoverAllAttunment: action,\n\n      sortedCharacters: computed,\n    });\n\n    this.characters = observable.array([]);\n  }\n\n  get sortedCharacters(): Array<DMCharacter> {\n    return [...this.characters].sort((a, b) => {\n      const ac = parseInt(a.initiative) + a.rolledInitiative;\n      const bc = parseInt(b.initiative) + b.rolledInitiative;\n\n      return bc - ac;\n    });\n  }\n\n  addCharacter(name: string): void {\n    this.characters.push({\n      id: shortid(),\n      name: this.getNonConflictName(name),\n      ...cloneDeep(DEFAULT_CHARACTER_PROPS),\n    });\n  }\n\n  removeCharacter(c: DMCharacter): void {\n    this.characters.remove(c);\n  }\n\n  rollInitiative(c: DMCharacter): void {\n    c.rolledInitiative = Math.ceil(Math.random() * 20);\n  }\n  rollAllInitiative(): void {\n    this.characters.forEach((c) => this.rollInitiative(c));\n  }\n\n  rollPerception(c: DMCharacter): void {\n    c.rolledPerception = Math.ceil(Math.random() * 20);\n  }\n  rollAllPerception(): void {\n    this.characters.forEach((c) => this.rollPerception(c));\n  }\n\n  rollSenseMotive(c: DMCharacter): void {\n    c.rolledSenseMotive = Math.ceil(Math.random() * 20);\n  }\n  rollAllSenseMotive(): void {\n    this.characters.forEach((c) => this.rollSenseMotive(c));\n  }\n\n  rollWillSave(c: DMCharacter): void {\n    c.rolledWillSave = Math.ceil(Math.random() * 20);\n  }\n  rollAllWillSave(): void {\n    this.characters.forEach((c) => this.rollWillSave(c));\n  }\n\n  heal(c: DMCharacter): void {\n    c.hp = c.maxHP;\n  }\n  healAll(): void {\n    this.characters.forEach((c) => {\n      c.hp = c.maxHP;\n    });\n  }\n\n  addTracker(c: DMCharacter): void {\n    c.trackers.push({\n      id: shortid(),\n      name: 'New Tracker',\n      remain: 0,\n      max: '0',\n    });\n  }\n  recoverTracker(c: DMCharacter): void {\n    c.trackers.forEach((t) => {\n      t.remain = parseInt(t.max);\n    });\n  }\n  recoverAllTracker(): void {\n    this.characters.forEach((c) => this.recoverTracker(c));\n  }\n\n  recoverAllAttunment(): void {\n    this.characters.forEach((c) => {\n      c.attunement = '0';\n    });\n  }\n\n  getNonConflictName(name: string): string {\n    const existed = this.characters.filter((c) => c.name.startsWith(name));\n\n    return `${name} ${existed.length + 1}`;\n  }\n\n  static parseCharacters(s: string): Array<DMCharacter> {\n    const json = JSON.parse(s);\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return json.map((c: any) => ({\n      ...DEFAULT_CHARACTER_PROPS,\n      ...c,\n    }));\n  }\n}\n","import Fuse from 'fuse.js';\n\nimport { Entity, Race, Spell, Feat, Class, Skill } from './types';\n\nimport SKILL_DATA from '../data/skills.json';\nimport RACE_DATA from '../data/races.json';\nimport CLASS_DATA from '../data/classes.json';\nimport SPELL_DATA from '../data/spells.json';\nimport FEAT_DATA from '../data/feats.json';\n\nexport type CollectionEntityType = 'skill' | 'race' | 'class' | 'spell' | 'feat' | 'weapon';\n\nexport interface CollectionOptions {\n  searchFields: Array<string>;\n}\n\nexport class Collection<T extends Entity = Entity> {\n  type: CollectionEntityType;\n  data: Array<T>;\n\n  fuse: Fuse<T>;\n\n  constructor(type: CollectionEntityType, data: Array<T>, options: CollectionOptions) {\n    this.type = type;\n    this.data = data;\n\n    this.fuse = new Fuse(data, {\n      includeScore: true,\n      threshold: 0.2,\n\n      keys: options.searchFields,\n    });\n  }\n\n  getById(id: string): T | null {\n    return this.data.find((s) => s.id === id) || null;\n  }\n}\n\nexport const collections = {\n  skill: new Collection<Skill>('skill', SKILL_DATA as Array<Skill>, {\n    searchFields: ['id', 'name'],\n  }),\n  race: new Collection<Race>('race', RACE_DATA, {\n    searchFields: ['id', 'name'],\n  }),\n  spell: new Collection<Spell>('spell', SPELL_DATA, {\n    searchFields: ['id', 'name'],\n  }),\n  feat: new Collection<Feat>('feat', FEAT_DATA, {\n    searchFields: ['id', 'name'],\n  }),\n  class: new Collection<Class>('class', CLASS_DATA, {\n    searchFields: ['id', 'name'],\n  }),\n};\n","import { mapValues } from 'lodash-es';\n\nimport { Abilities, AbilityType } from '../store/types';\n\nexport const ABILITY_TYPES = [\n  AbilityType.str,\n  AbilityType.dex,\n  AbilityType.con,\n  AbilityType.int,\n  AbilityType.wis,\n  AbilityType.cha,\n];\n\nexport const abilityTranslates = {\n  str: '力量',\n  dex: '敏捷',\n  con: '体质',\n  int: '智力',\n  wis: '感知',\n  cha: '魅力',\n};\n\nexport function addBonusScores(base: Abilities, bonus: Partial<Abilities>): Abilities {\n  return {\n    str: base.str + (bonus.str ?? 0),\n    dex: base.dex + (bonus.dex ?? 0),\n    con: base.con + (bonus.con ?? 0),\n    int: base.int + (bonus.int ?? 0),\n    wis: base.wis + (bonus.wis ?? 0),\n    cha: base.cha + (bonus.cha ?? 0),\n  };\n}\n\nexport function getModifierFromScore(score: number): number {\n  return Math.floor((score - 10) / 2);\n}\n\nexport function getModifiers(ab: Abilities): Abilities {\n  return mapValues(ab, getModifierFromScore);\n}\n\nexport function showModifier(mod: number): string {\n  return `${mod < 0 ? '' : '+'}${mod}`;\n}\n\nexport const ABILITY_COST: Record<number, number> = {\n  7: -4,\n  8: -2,\n  9: -1,\n  10: 0,\n  11: 1,\n  12: 2,\n  13: 3,\n  14: 5,\n  15: 7,\n  16: 10,\n  17: 13,\n  18: 17,\n};\n\nexport const MINIMUM_ABILITY_SCORE = 7;\nexport const MAXIMUM_ABILITY_SCORE = 18;\nexport const ABILITY_POINTS = 25;\n\nexport function getScoreCost(score: number): number {\n  return ABILITY_COST[score] ?? 0;\n}\n\nexport function getTotalScoreCosts(ab: Abilities): number {\n  return Object.values(ab)\n    .map((v) => getScoreCost(v))\n    .reduce((acc, v) => acc + v, 0);\n}\n","import { isEmpty, pick } from 'lodash-es';\nimport { observable, makeObservable, ObservableSet, ObservableMap, computed, action } from 'mobx';\nimport shortid from 'shortid';\n\nimport { createContextNoNullCheck } from '../utils/react';\nimport { collections } from './collection';\nimport { Abilities, Spell, Race, AbilityType, Skill, Class } from './types';\nimport { getModifiers, getTotalScoreCosts, addBonusScores } from '../utils/ability';\n\ninterface OptionalCharacterParams {\n  id?: string;\n  baseAbility?: Abilities;\n  bonusAbilityType?: AbilityType;\n\n  level?: number;\n\n  raceId?: string;\n  classId?: string;\n  skillRanks?: Array<[string, number]>;\n  spellbookIds?: string[];\n}\n\nexport default class Character {\n  id: string;\n  name: string;\n  baseAbility: Abilities;\n  bonusAbilityType: AbilityType;\n\n  level: number;\n\n  raceId: string;\n  classId: string;\n  skillRanks: ObservableMap<string, number>;\n  spellbookIds: ObservableSet<string>;\n\n  constructor(\n    name: string,\n    {\n      id,\n      baseAbility,\n      bonusAbilityType = AbilityType.str,\n      level = 1,\n      raceId = 'Human',\n      classId = 'Fighter',\n      skillRanks = [],\n      spellbookIds,\n    }: OptionalCharacterParams = {}\n  ) {\n    makeObservable(this, {\n      name: observable,\n      baseAbility: observable,\n\n      abilityModifier: computed,\n      abilityCost: computed,\n\n      bonusAbilityType: observable,\n      bonusAbility: computed,\n\n      raceId: observable,\n      race: computed,\n      setRace: action,\n\n      classId: observable,\n      class: computed,\n\n      spellbook: computed,\n    });\n\n    this.name = name;\n    this.id = id ?? shortid.generate();\n\n    this.baseAbility = baseAbility ?? { str: 10, dex: 10, con: 10, int: 10, wis: 10, cha: 10 };\n    this.bonusAbilityType = bonusAbilityType ?? AbilityType.str;\n\n    this.level = level;\n\n    this.raceId = raceId;\n    this.classId = classId;\n\n    this.skillRanks = observable.map(new Map<string, number>(skillRanks), { deep: false });\n\n    this.spellbookIds = observable.set(new Set(spellbookIds), { deep: false });\n  }\n\n  get race(): Race {\n    return (\n      collections.race.getById(this.raceId) || {\n        id: 'unknown',\n        name: '未知',\n        ability: {},\n      }\n    );\n  }\n  setRace(raceId: string): void {\n    this.raceId = raceId;\n    this.bonusAbilityType = AbilityType.str;\n  }\n\n  get class(): Class {\n    return (\n      collections.class.getById(this.classId) || {\n        id: 'unknown',\n        name: '未知',\n        hd: 0,\n        classSkills: [],\n      }\n    );\n  }\n\n  get ability(): Abilities {\n    return addBonusScores(this.baseAbility, this.bonusAbility);\n  }\n  get abilityModifier(): Abilities {\n    return getModifiers(this.ability);\n  }\n  get abilityCost(): number {\n    return getTotalScoreCosts(this.baseAbility);\n  }\n  get bonusAbility(): Partial<Abilities> {\n    if (isEmpty(this.race.ability)) {\n      return { [this.bonusAbilityType]: 2 };\n    }\n\n    return this.race.ability;\n  }\n  resetBaseAbility(): void {\n    this.baseAbility = { str: 10, dex: 10, con: 10, int: 10, wis: 10, cha: 10 };\n  }\n\n  isClassSkill(s: Skill): boolean {\n    return this.class.classSkills.includes(s.id);\n  }\n  getSkillDetail(\n    s: Skill\n  ): { rank: number; modifier: number; classBonus: number; isClassSkill: boolean; total: number } {\n    const rank = this.skillRanks.get(s.id) || 0;\n    const modifier = this.abilityModifier[s.ability];\n    const isClassSkill = this.isClassSkill(s);\n    const classBonus = rank > 0 && isClassSkill ? 3 : 0;\n\n    return { rank, modifier, classBonus, isClassSkill, total: rank + modifier + classBonus };\n  }\n\n  get spellbook(): Array<Spell> {\n    return Array.from(this.spellbookIds)\n      .map((id) => collections.spell.getById(id))\n      .filter((t): t is Spell => Boolean(t));\n  }\n\n  static serializableProps = [\n    'raceId',\n    'classId',\n    'baseAbility',\n    'bonusAbilityType',\n    'spellbookIds',\n  ];\n\n  static stringify(c: Character): string {\n    return JSON.stringify({\n      id: c.id,\n      name: c.name,\n      spellbook: Array.from(c.spellbook).map((s) => s.id),\n      ...pick(c, Character.serializableProps),\n    });\n  }\n\n  static parse(s: string): Character {\n    const json = JSON.parse(s);\n    const character = new Character(json.name, json);\n\n    return character;\n  }\n}\n\nexport const [useCurrentCharacter, CurrentCharacterContext] = createContextNoNullCheck<Character>();\n","import Fuse from 'fuse.js';\nimport { observable, IObservableArray, autorun } from 'mobx';\nimport { set, entries } from 'idb-keyval';\n\nimport { createContextNoNullCheck } from '../utils/react';\n\nimport { Entity } from './types';\nimport DMStore from './dm';\nimport { collections, Collection, CollectionEntityType } from './collection';\nimport Character from './character';\n\nexport class Store {\n  dm: DMStore;\n\n  collections: typeof collections; // for components\n\n  characters: IObservableArray<Character>;\n\n  constructor() {\n    this.dm = new DMStore();\n\n    this.collections = collections;\n\n    this.characters = observable.array([], { deep: false });\n  }\n\n  async init(): Promise<void> {\n    await this.restore();\n    this.persist();\n  }\n\n  quickSearch(\n    key: string,\n    limitEach = 20\n  ): Array<[CollectionEntityType, Fuse.FuseResult<Entity>[]]> {\n    return ([collections.spell, collections.feat] as Array<Collection<Entity>>).map((c) => [\n      c.type,\n      c.fuse.search(key, { limit: limitEach }),\n    ]);\n  }\n\n  persist(): void {\n    autorun(() => {\n      this.characters.forEach((c) => {\n        set(`character:${c.id}`, Character.stringify(c));\n      });\n\n      set('dm:characters', JSON.stringify(this.dm.characters));\n    });\n  }\n\n  async restore(): Promise<void> {\n    const persisted = await entries();\n\n    persisted.forEach(([k, v]) => {\n      if (typeof k === 'string') {\n        if (k.startsWith('character')) {\n          this.characters.push(Character.parse(v));\n        }\n\n        if (k === 'dm:characters') {\n          this.dm.characters.replace(DMStore.parseCharacters(v));\n        }\n      }\n    });\n\n    if (this.characters.length < 1) {\n      this.characters.push(new Character('Default'));\n    }\n  }\n}\n\nexport const [useStore, StoreContext] = createContextNoNullCheck<Store>();\n","export const entityTypeTranslates = {\n  skill: '技能',\n  race: '种族',\n  class: '职业',\n  spell: '法术',\n  feat: '专长',\n  weapon: '武器',\n};\n","export const translates = {\n  school: '学派',\n  level: '环位',\n  domain: '领域',\n  castingTime: '施法时间',\n  components: '成分',\n  range: '距离',\n  effect: '效果',\n  target: '目标',\n  area: '区域',\n  aiming: '目标, 区域或区域',\n  duration: '持续时间',\n  saving: '豁免',\n  resistance: '法术抗力',\n};\n","import './Spell.scss';\n\nimport { Box, Heading, Badge, Text, Stack, Table, Tbody, Tr, Td } from '@chakra-ui/react';\n\nimport { ENTITY_COLORS } from '../constant';\nimport { Spell as SpellType, SpellMeta as SpellMetaType } from '../store/types';\nimport { translates as spellTranslates } from '../utils/spell';\n\ninterface Props {\n  spell: SpellType;\n  showName?: boolean;\n  showMeta?: boolean;\n  showDescription?: boolean;\n}\n\nexport function SpellMeta({ spell }: Props): JSX.Element {\n  return (\n    <Table size=\"sm\" mt=\"2\">\n      <Tbody>\n        {(Object.keys(spell.meta) as Array<keyof SpellMetaType>).map((k) => (\n          <Tr key={k}>\n            <Td pl=\"0\" color=\"blue.500\" width=\"8em\">\n              {spellTranslates[k]}\n            </Td>\n            <Td>{spell.meta[k]}</Td>\n          </Tr>\n        ))}\n      </Tbody>\n    </Table>\n  );\n}\n\nexport default function Spell({\n  spell,\n  showName = true,\n  showMeta = true,\n  showDescription = true,\n}: Props): JSX.Element {\n  return (\n    <Box className=\"spell\">\n      {showName ? (\n        <Stack direction=\"row\" align=\"center\">\n          <Badge>{spell.book.toUpperCase()}</Badge>\n          <Heading as=\"h4\" fontSize=\"lg\" color={ENTITY_COLORS.spell}>\n            {spell.name} <small style={{ fontWeight: 'normal' }}>({spell.id})</small>\n          </Heading>\n        </Stack>\n      ) : null}\n\n      {showMeta ? <SpellMeta spell={spell} /> : null}\n\n      {showDescription ? (\n        <Text\n          pt=\"1\"\n          whiteSpace=\"pre-wrap\"\n          dangerouslySetInnerHTML={{ __html: spell.description }}\n          className=\"spell-description\"\n        />\n      ) : null}\n    </Box>\n  );\n}\n","export const featTranslates = {\n  requirement: '先决条件',\n  benefit: '专长效果',\n  normal: '通常状况',\n  special: '特殊说明',\n};\n","import './Feat.scss';\n\nimport { Box, HStack, Badge, Heading, Table, Tbody, Tr, Td, Text } from '@chakra-ui/react';\n\nimport { ENTITY_COLORS } from '../constant';\nimport { Feat as FeatType, FeatMeta as FeatMetaType } from '../store/types';\nimport { featTranslates } from '../utils/feat';\n\ninterface Props {\n  feat: FeatType;\n  showName?: boolean;\n  showBrief?: boolean;\n  showMeta?: boolean;\n  showDescription?: boolean;\n}\n\nfunction FeatMeta({ feat }: { feat: FeatType }) {\n  return (\n    <Table size=\"sm\" mt=\"2\">\n      <Tbody>\n        {(Object.keys(feat.meta) as Array<keyof FeatMetaType>).map((k) => (\n          <Tr key={k}>\n            <Td pl=\"0\" color=\"blue.500\" width=\"8em\">\n              {featTranslates[k]}\n            </Td>\n            <Td>{feat.meta[k]}</Td>\n          </Tr>\n        ))}\n      </Tbody>\n    </Table>\n  );\n}\n\nexport default function Feat({\n  feat,\n  showName = true,\n  showBrief = true,\n  showMeta = true,\n  showDescription = true,\n}: Props): JSX.Element {\n  return (\n    <Box className=\"feat\">\n      {showName ? (\n        <HStack direction=\"row\" align=\"center\">\n          <Badge>{feat.book.toUpperCase()}</Badge>\n          <Heading as=\"h4\" fontSize=\"lg\" color={ENTITY_COLORS.feat}>\n            {feat.name} <small style={{ fontWeight: 'normal' }}>({feat.id})</small>\n          </Heading>\n        </HStack>\n      ) : null}\n\n      {showBrief ? (\n        <Text mt=\"2\" fontStyle=\"italic\">\n          {feat.brief}\n        </Text>\n      ) : null}\n\n      {showMeta ? <FeatMeta feat={feat} /> : null}\n\n      {showDescription && feat.description ? (\n        <Text\n          pt=\"1\"\n          whiteSpace=\"pre-wrap\"\n          dangerouslySetInnerHTML={{ __html: feat.description }}\n          className=\"feat-description\"\n        />\n      ) : null}\n    </Box>\n  );\n}\n","import { useEffect, useMemo, useState } from 'react';\nimport {\n  Box,\n  InputGroup,\n  Input,\n  InputLeftElement,\n  Menu,\n  MenuButton,\n  MenuItem,\n  MenuList,\n  Button,\n  Tag,\n  HStack,\n} from '@chakra-ui/react';\nimport { Search2Icon, ChevronDownIcon } from '@chakra-ui/icons';\n\nimport { ENTITY_COLORS } from '../constant';\nimport { useStore } from '../store';\nimport { CollectionEntityType } from '../store/collection';\nimport { Entity, Spell as SpellType, Feat as FeatType } from '../store/types';\nimport { useIsSmallerScreen } from '../utils/react';\nimport { entityTypeTranslates } from '../utils/entity';\nimport Spell from './Spell';\nimport Feat from './Feat';\n\nfunction QuickSearchResultItem({ item, type }: { item: Entity; type: CollectionEntityType }) {\n  let el = null;\n\n  switch (type) {\n    case 'spell':\n      el = <Spell spell={item as SpellType} />;\n      break;\n    case 'feat':\n      el = <Feat feat={item as FeatType} />;\n      break;\n    default:\n      break;\n  }\n\n  return (\n    <Box\n      mb=\"2\"\n      border=\"1px\"\n      borderColor=\"gray.200\"\n      p=\"2\"\n      borderRadius=\"md\"\n      _hover={{\n        borderColor: 'gray.300',\n        boxShadow: 'base',\n      }}\n      transition=\"all .2s ease-in-out\"\n    >\n      {el}\n    </Box>\n  );\n}\n\nexport default function QuickSearch(): JSX.Element {\n  const store = useStore();\n  const [searchKey, setSearchKey] = useState('');\n  const searchResult = useMemo(() => store.quickSearch(searchKey), [searchKey]);\n  const [currentType, setCurrentType] = useState(() => searchResult?.[0]?.[0]);\n  const isSmallerScreen = useIsSmallerScreen();\n  const [resultType, results] = searchResult.find(([t]) => currentType === t) || [];\n\n  useEffect(() => {\n    const hasResult = searchResult.filter(([, r]) => r.length > 0);\n\n    if (!hasResult.map(([t]) => t).includes(currentType)) {\n      setCurrentType(hasResult[0]?.[0]);\n    }\n  }, [currentType, searchResult]);\n\n  return (\n    <>\n      <Box flexGrow={0} flexShrink={0} mb=\"2\">\n        <InputGroup>\n          <InputLeftElement>\n            <Search2Icon color=\"gray.400\" />\n          </InputLeftElement>\n          <Input\n            placeholder=\"计划是搜一切\"\n            autoFocus\n            value={searchKey}\n            onChange={(e) => {\n              setSearchKey(e.target.value);\n            }}\n          />\n        </InputGroup>\n        {results && results?.length > 0 ? (\n          isSmallerScreen ? (\n            <Menu matchWidth autoSelect={false}>\n              <MenuButton\n                mt=\"2\"\n                as={Button}\n                rightIcon={<ChevronDownIcon />}\n                variant=\"outline\"\n                width=\"100%\"\n                colorScheme=\"blackAlpha\"\n              >\n                {entityTypeTranslates[currentType]}\n              </MenuButton>\n              <MenuList>\n                {searchResult.map(([type, r]) =>\n                  r.length > 0 ? (\n                    <MenuItem\n                      key={type}\n                      onClick={() => {\n                        setCurrentType(type);\n                      }}\n                    >\n                      {entityTypeTranslates[type]}\n                    </MenuItem>\n                  ) : null\n                )}\n              </MenuList>\n            </Menu>\n          ) : (\n            <HStack pt=\"2\">\n              {searchResult.map(([type, r]) =>\n                r.length > 0 ? (\n                  <Tag\n                    key={type}\n                    onClick={() => setCurrentType(type)}\n                    bgColor={ENTITY_COLORS[type]}\n                    color=\"white\"\n                    cursor=\"pointer\"\n                    size=\"lg\"\n                    opacity={type === currentType ? 1 : 0.6}\n                  >\n                    {entityTypeTranslates[type]}({r.length})\n                  </Tag>\n                ) : null\n              )}\n            </HStack>\n          )\n        ) : null}\n      </Box>\n      {results && resultType && results?.length > 0 ? (\n        <Box flexGrow={1} overflowY=\"auto\" key={resultType}>\n          {results.map(({ item }) => (\n            <QuickSearchResultItem key={item.id} type={resultType} item={item} />\n          ))}\n        </Box>\n      ) : null}\n    </>\n  );\n}\n","import {\n  Drawer,\n  DrawerHeader,\n  DrawerOverlay,\n  DrawerContent,\n  DrawerCloseButton,\n  DrawerBody,\n  useDisclosure,\n} from '@chakra-ui/react';\n\nimport QuickSearch from './QuickSearch';\n\ninterface Props {\n  children: JSX.Element;\n}\n\nexport default function QuickSearchToggler({ children }: Props): JSX.Element {\n  const { isOpen, onClose, onOpen } = useDisclosure();\n\n  return (\n    <>\n      <span onClick={onOpen}>{children}</span>\n\n      <Drawer isOpen={isOpen} onClose={onClose} size=\"lg\">\n        <DrawerOverlay>\n          <DrawerContent>\n            <DrawerHeader>搜一切</DrawerHeader>\n            <DrawerBody d=\"flex\" flexDir=\"column\">\n              <QuickSearch />\n            </DrawerBody>\n            <DrawerCloseButton />\n          </DrawerContent>\n        </DrawerOverlay>\n      </Drawer>\n    </>\n  );\n}\n","import { Link, LinkProps } from '@chakra-ui/react';\nimport { Link as RouterLink, LinkProps as RouterLinkProps, useRouteMatch } from 'react-router-dom';\n\ninterface Props\n  extends LinkProps,\n    Pick<RouterLinkProps, 'to' | 'component' | 'innerRef' | 'replace'> {\n  to: string;\n}\n\nexport default function NavLink({ to, ...props }: Props): JSX.Element {\n  const match = useRouteMatch(to);\n\n  return <Link as={RouterLink} color={match ? 'teal.400' : 'black'} to={to} {...props} />;\n}\n","import { Box, Container, Heading, Flex, Spacer, IconButton, HStack, Icon } from '@chakra-ui/react';\nimport { Search2Icon } from '@chakra-ui/icons';\nimport { GiAncientSword } from 'react-icons/gi';\n\nimport QuickSearchToggler from './QuickSearchToggler';\nimport NavLink from './NavLink';\n\nexport default function Navbar(): JSX.Element {\n  return (\n    <Box bg=\"white\" borderBottom=\"1px\" borderColor=\"gray.300\" py={3}>\n      <Container>\n        <Flex alignItems=\"center\">\n          <HStack mr=\"8\" color=\"gray.700\">\n            <Icon as={GiAncientSword} h=\"28px\" w=\"28px\" />\n            <Heading as=\"h1\" fontSize=\"large\">\n              PFWB\n            </Heading>\n          </HStack>\n          <HStack>\n            <NavLink to=\"/player\">PC</NavLink>\n            <NavLink to=\"/dm\">DM</NavLink>\n          </HStack>\n          <Spacer />\n          <QuickSearchToggler>\n            <IconButton aria-label=\"Quick Search\" size=\"sm\" icon={<Search2Icon />} />\n          </QuickSearchToggler>\n        </Flex>\n      </Container>\n    </Box>\n  );\n}\n","import { Box, Icon } from '@chakra-ui/react';\nimport {\n  GiFist,\n  GiBullseye,\n  GiShield,\n  GiBrain,\n  GiAerialSignal,\n  GiFlyingFlag,\n} from 'react-icons/gi';\n\nimport { AbilityType } from '../store/types';\n\nconst icons = {\n  str: { icon: GiFist, color: 'orange.500' },\n  dex: { icon: GiBullseye, color: 'green.500' },\n  con: { icon: GiShield, color: 'red.500' },\n  int: { icon: GiBrain, color: 'yellow.500' },\n  wis: { icon: GiAerialSignal, color: 'cyan.500' },\n  cha: { icon: GiFlyingFlag, color: 'pink.500' },\n};\n\nexport default function AbilityIcon({ ability }: { ability: AbilityType }): JSX.Element {\n  const { icon, color } = icons[ability];\n\n  return (\n    <Box bgColor={color} p=\"1\" borderRadius=\"md\">\n      <Icon as={icon} color=\"white\" w={8} h={8} />\n    </Box>\n  );\n}\n","import { VStack, Text } from '@chakra-ui/react';\n\ninterface Props {\n  number: string | number;\n  text: string;\n}\n\nexport default function StatNumber({ number, text }: Props): JSX.Element {\n  return (\n    <VStack spacing=\"0\">\n      <Text fontSize=\"large\" textAlign=\"center\" lineHeight=\"1\">\n        {number}\n      </Text>\n      <Text fontSize=\"xs\" color=\"gray.500\" lineHeight=\"1\">\n        {text}\n      </Text>\n    </VStack>\n  );\n}\n","import { HStack, Spacer, IconButton, Text, ButtonGroup } from '@chakra-ui/react';\nimport { FaPlus, FaMinus } from 'react-icons/fa';\n\nimport { AbilityType } from '../store/types';\nimport {\n  getModifierFromScore,\n  showModifier,\n  MAXIMUM_ABILITY_SCORE,\n  MINIMUM_ABILITY_SCORE,\n} from '../utils/ability';\n\nimport AbilityIcon from './AbilityIcon';\nimport StatNumber from './StatNumber';\n\ninterface Props {\n  ability: AbilityType;\n  score: number;\n  onChange: (s: number) => void;\n  max?: number;\n  min?: number;\n  isIncreaseDisabled?: boolean;\n  racial?: number;\n}\n\nexport default function AbilityInput({\n  ability,\n  score,\n  onChange,\n  max = MAXIMUM_ABILITY_SCORE,\n  min = MINIMUM_ABILITY_SCORE,\n  racial = 0,\n  isIncreaseDisabled = false,\n}: Props): JSX.Element {\n  return (\n    <HStack w=\"full\">\n      <AbilityIcon ability={ability} />\n      <Text fontSize=\"lg\" fontFamily=\"mono\">\n        {ability.toUpperCase()}\n      </Text>\n      <Spacer />\n      <StatNumber number={showModifier(getModifierFromScore(score + racial))} text=\"mod\" />\n      <StatNumber number={showModifier(racial)} text=\"racial\" />\n      <StatNumber number={score + racial} text=\"score\" />\n\n      <ButtonGroup isAttached>\n        <IconButton\n          aria-label=\"Decrease Ability\"\n          icon={<FaMinus />}\n          onClick={() => onChange(score - 1)}\n          size=\"sm\"\n          isDisabled={score <= min}\n        />\n        <IconButton\n          aria-label=\"Increase Ability\"\n          icon={<FaPlus />}\n          onClick={() => onChange(score + 1)}\n          size=\"sm\"\n          isDisabled={score >= max || isIncreaseDisabled}\n        />\n      </ButtonGroup>\n    </HStack>\n  );\n}\n","import { Button, Menu, MenuButton, MenuItem, MenuList, Icon } from '@chakra-ui/react';\nimport { FaCheck } from 'react-icons/fa';\n\nimport { Collection } from '../store/collection';\n\ninterface Props {\n  collection: Collection;\n  onChange: (v: string) => void;\n  value: string | null;\n  placeholder?: string;\n}\n\nexport default function CollectionEntitySelect({\n  collection,\n  onChange,\n  value,\n  placeholder = 'Select',\n}: Props): JSX.Element {\n  return (\n    <Menu placement=\"bottom-start\">\n      <MenuButton as={Button}>\n        {(value ? collection.getById(value)?.name : '') || placeholder}\n      </MenuButton>\n      <MenuList>\n        {collection.data.map((e) => (\n          <MenuItem\n            key={e.id}\n            onClick={() => {\n              onChange(e.id);\n            }}\n            icon={e.id === value ? <Icon as={FaCheck} /> : undefined}\n          >\n            {e.name}\n          </MenuItem>\n        ))}\n      </MenuList>\n    </Menu>\n  );\n}\n","import { Button, Menu, MenuButton, MenuItem, MenuList, Icon } from '@chakra-ui/react';\nimport { FaCheck } from 'react-icons/fa';\n\ninterface Props<T = string> {\n  options: Array<{ text: string; value: T; key?: string }>;\n  onChange: (v: T) => void;\n  value: T | null;\n  placeholder?: string;\n}\n\nexport default function Select<T>({\n  options,\n  value,\n  onChange,\n  placeholder = 'Select',\n}: Props<T>): JSX.Element {\n  return (\n    <Menu placement=\"bottom-start\">\n      <MenuButton as={Button}>\n        {(value ? options.find(({ value: v }) => v === value)?.text : '') || placeholder}\n      </MenuButton>\n      <MenuList>\n        {options.map((o, i) => (\n          <MenuItem\n            key={o.key ?? i}\n            onClick={() => {\n              onChange(o.value);\n            }}\n            icon={o.value === value ? <Icon as={FaCheck} /> : undefined}\n          >\n            {o.text}\n          </MenuItem>\n        ))}\n      </MenuList>\n    </Menu>\n  );\n}\n","import { isEmpty } from 'lodash-es';\nimport { Observer } from 'mobx-react-lite';\nimport { Button, Box, VStack, Text, HStack, Spacer, Divider } from '@chakra-ui/react';\n\nimport { useStore } from '../../store';\nimport { useCurrentCharacter } from '../../store/character';\nimport {\n  ABILITY_TYPES,\n  getScoreCost,\n  ABILITY_POINTS,\n  abilityTranslates,\n} from '../../utils/ability';\n\nimport AbilityInput from '../AbilityInput';\nimport CollectionEntitySelect from '../CollectionEntitySelect';\nimport Select from '../Select';\n\nexport default function CharacterBasic(): JSX.Element {\n  const store = useStore();\n  const character = useCurrentCharacter();\n\n  return (\n    <Box maxW=\"sm\">\n      <Observer>\n        {() => (\n          <VStack w=\"full\">\n            <HStack w=\"full\" spacing=\"0\">\n              <Text fontSize=\"lg\">种族</Text>\n              <Spacer />\n              <CollectionEntitySelect\n                collection={store.collections.race}\n                value={character.raceId}\n                onChange={(id) => {\n                  character.raceId = id;\n                }}\n              />\n            </HStack>\n            <Divider />\n            {isEmpty(character.race.ability) ? (\n              <>\n                <HStack w=\"full\" spacing=\"0\">\n                  <Text fontSize=\"lg\">能力奖励</Text>\n                  <Spacer />\n                  <Select\n                    options={ABILITY_TYPES.map((t) => ({\n                      text: abilityTranslates[t],\n                      value: t,\n                      key: t,\n                    }))}\n                    value={character.bonusAbilityType}\n                    onChange={(v) => {\n                      character.bonusAbilityType = v;\n                    }}\n                  />\n                </HStack>\n                <Divider />\n              </>\n            ) : null}\n            <HStack w=\"full\" spacing=\"0\">\n              <Text fontSize=\"lg\">职业</Text>\n              <Spacer />\n              <CollectionEntitySelect\n                collection={store.collections.class}\n                value={character.classId}\n                onChange={(id) => {\n                  character.classId = id;\n                }}\n              />\n            </HStack>\n            <Divider />\n          </VStack>\n        )}\n      </Observer>\n      <Observer>\n        {() => {\n          const remainPoints = ABILITY_POINTS - character.abilityCost;\n\n          return (\n            <>\n              <HStack my=\"2\">\n                <Text fontSize=\"lg\">点数: {remainPoints} / 25</Text>\n                <Button size=\"xs\" onClick={() => character.resetBaseAbility()}>\n                  重置\n                </Button>\n              </HStack>\n              <VStack alignItems=\"start\">\n                {ABILITY_TYPES.map((ab) => {\n                  const score = character.baseAbility[ab];\n\n                  return (\n                    <AbilityInput\n                      key={ab}\n                      ability={ab}\n                      score={score}\n                      racial={character.bonusAbility[ab]}\n                      onChange={(v) => {\n                        character.baseAbility[ab] = v;\n                      }}\n                      isIncreaseDisabled={\n                        character.abilityCost >= ABILITY_POINTS ||\n                        getScoreCost(score + 1) - getScoreCost(score) > remainPoints\n                      }\n                    />\n                  );\n                })}\n              </VStack>\n            </>\n          );\n        }}\n      </Observer>\n    </Box>\n  );\n}\n","import { HStack, Text, Icon, Spacer, ButtonGroup, IconButton } from '@chakra-ui/react';\nimport { FaStar, FaMinus, FaPlus } from 'react-icons/fa';\n\nimport { Skill } from '../store/types';\n\nimport AbilityIcon from './AbilityIcon';\nimport StatNumber from './StatNumber';\n\ninterface Props {\n  skill: Skill;\n  rank: number;\n  total: number;\n  modifier: number;\n  isClassSkill: boolean;\n  max: number;\n  min: number;\n  onChange: (s: number) => void;\n}\n\nexport default function SkillInput({\n  skill,\n  rank,\n  modifier,\n  total,\n  isClassSkill,\n  max,\n  min,\n  onChange,\n}: Props): JSX.Element {\n  return (\n    <HStack w=\"full\">\n      <AbilityIcon ability={skill.ability} />\n      <Text fontSize=\"large\">\n        {skill.name} {isClassSkill ? <Icon as={FaStar} color=\"gray.600\" /> : null}\n      </Text>\n      <Spacer />\n      <StatNumber number={rank} text=\"rank\" />\n      <StatNumber number={modifier} text=\"mod\" />\n      <StatNumber number={total} text=\"total\" />\n\n      <ButtonGroup isAttached>\n        <IconButton\n          aria-label=\"Decrease Ability\"\n          icon={<FaMinus />}\n          onClick={() => onChange(rank - 1)}\n          size=\"sm\"\n          disabled={rank <= min}\n        />\n        <IconButton\n          aria-label=\"Increase Ability\"\n          icon={<FaPlus />}\n          onClick={() => onChange(rank + 1)}\n          size=\"sm\"\n          disabled={rank >= max}\n        />\n      </ButtonGroup>\n    </HStack>\n  );\n}\n","import { Observer } from 'mobx-react-lite';\nimport { Box, VStack } from '@chakra-ui/react';\n\nimport { useStore } from '../../store';\nimport { useCurrentCharacter } from '../../store/character';\n\nimport SkillInput from '../SkillInput';\n\nexport default function CharacterSkills(): JSX.Element {\n  const store = useStore();\n  const character = useCurrentCharacter();\n\n  return (\n    <Box maxW=\"sm\">\n      <Observer>\n        {() => (\n          <VStack align=\"start\" w=\"full\">\n            {store.collections.skill.data.map((s) => (\n              <SkillInput\n                key={s.id}\n                skill={s}\n                onChange={(r) => {\n                  character.skillRanks.set(s.id, r);\n                }}\n                max={character.level}\n                min={0}\n                {...character.getSkillDetail(s)}\n              />\n            ))}\n          </VStack>\n        )}\n      </Observer>\n    </Box>\n  );\n}\n","import { useMemo, useState, MutableRefObject } from 'react';\nimport { Box, InputGroup, Input, InputLeftElement, Icon, Text, HStack } from '@chakra-ui/react';\nimport { FaSearch, FaCheck } from 'react-icons/fa';\n\nimport { Collection } from '../store/collection';\n\ninterface Props {\n  collection: Collection;\n  onPick: (id: string) => void;\n  items: Array<string>;\n  inputRef?: MutableRefObject<HTMLInputElement | null>;\n}\n\nexport default function CollectionEntityPicker({\n  collection,\n  inputRef,\n  onPick,\n  items,\n}: Props): JSX.Element {\n  const [searchKey, setSearchKey] = useState('');\n  const searchResult = useMemo(() => {\n    return collection?.fuse.search(searchKey) || [];\n  }, [searchKey]);\n\n  return (\n    <Box>\n      <InputGroup>\n        <InputLeftElement>\n          <Icon as={FaSearch} color=\"gray.400\" />\n        </InputLeftElement>\n        <Input\n          ref={inputRef}\n          placeholder=\"Search\"\n          autoFocus\n          value={searchKey}\n          onChange={(e) => {\n            setSearchKey(e.target.value);\n          }}\n        />\n      </InputGroup>\n      {searchResult.length > 0 ? (\n        <Box borderTop=\"1px\" borderColor=\"gray.100\" mt=\"2\" maxH={300} overflow=\"auto\">\n          {searchResult.map(({ item }) => {\n            const picked = items.includes(item.id);\n\n            return (\n              <HStack\n                key={item.id}\n                onClick={() => {\n                  if (!picked) onPick(item.id);\n                }}\n                p=\"2\"\n                borderBottom=\"1px\"\n                borderColor=\"gray.200\"\n                _hover={{\n                  background: 'gray.100',\n                }}\n                color={picked ? 'gray.400' : 'black'}\n                cursor={picked ? 'not-allowed' : 'pointer'}\n              >\n                {picked ? <Icon as={FaCheck} /> : null}\n                <Text>\n                  {item.name} ({item.id})\n                </Text>\n              </HStack>\n            );\n          })}\n        </Box>\n      ) : null}\n    </Box>\n  );\n}\n","import {\n  Button,\n  Flex,\n  Spacer,\n  Divider,\n  SimpleGrid,\n  PopoverTrigger,\n  Popover,\n  PopoverContent,\n  PopoverBody,\n  PopoverArrow,\n  Drawer,\n  DrawerOverlay,\n  DrawerContent,\n  DrawerCloseButton,\n  DrawerBody,\n} from '@chakra-ui/react';\nimport { DeleteIcon } from '@chakra-ui/icons';\nimport { useRef, useState } from 'react';\nimport { Observer } from 'mobx-react-lite';\n\nimport CollectionEntityPicker from '../CollectionEntityPicker';\n\nimport { useStore } from '../../store';\nimport { Spell as SpellType } from '../../store/types';\nimport { useCurrentCharacter } from '../../store/character';\nimport { useIsSmallerScreen } from '../../utils/react';\n\nimport Spell from '../Spell';\n\nexport default function CharacterSpellbook(): JSX.Element {\n  const store = useStore();\n  const initialFocusRef = useRef<HTMLInputElement>(null);\n  const character = useCurrentCharacter();\n  const [showSpell, setShowSpell] = useState<SpellType | null>();\n  const isSmallerScreen = useIsSmallerScreen();\n\n  return (\n    <>\n      <Popover initialFocusRef={initialFocusRef} placement=\"bottom-start\">\n        <PopoverTrigger>\n          <Button size=\"sm\">添加法术</Button>\n        </PopoverTrigger>\n        <PopoverContent>\n          <PopoverBody>\n            <PopoverArrow />\n            <Observer>\n              {() => (\n                <CollectionEntityPicker\n                  collection={store.collections.spell}\n                  inputRef={initialFocusRef}\n                  onPick={(id) => {\n                    character.spellbookIds.add(id);\n                  }}\n                  items={Array.from(character.spellbookIds)}\n                />\n              )}\n            </Observer>\n          </PopoverBody>\n        </PopoverContent>\n      </Popover>\n      <Divider my=\"2\" />\n      <Observer>\n        {() => (\n          <SimpleGrid columns={isSmallerScreen ? 1 : 3} spacing=\"2\">\n            {Array.from(character.spellbook).map((spell) => (\n              <Flex\n                key={spell.id}\n                cursor=\"pointer\"\n                transition=\"box-shadow 0.2s ease-in-out\"\n                _hover={{ boxShadow: 'base' }}\n                border=\"1px\"\n                borderColor=\"gray.200\"\n                p=\"2\"\n                borderRadius=\"md\"\n                onClick={() => setShowSpell(spell)}\n                align=\"center\"\n              >\n                <Spell spell={spell} showMeta={false} showDescription={false} />\n                <Spacer />\n                <DeleteIcon\n                  color=\"red.500\"\n                  transition=\"color 0.2s ease-in-out\"\n                  _hover={{ color: 'red.600' }}\n                  onClick={(e) => {\n                    if (confirm('Are you sure?')) {\n                      character.spellbookIds.delete(spell.id);\n                    }\n                    e.stopPropagation();\n                  }}\n                />\n              </Flex>\n            ))}\n          </SimpleGrid>\n        )}\n      </Observer>\n\n      <Drawer\n        isOpen={Boolean(showSpell)}\n        onClose={() => {\n          setShowSpell(null);\n        }}\n        size=\"lg\"\n      >\n        <DrawerOverlay>\n          <DrawerContent>\n            <DrawerBody>{showSpell ? <Spell spell={showSpell} /> : null}</DrawerBody>\n            <DrawerCloseButton />\n          </DrawerContent>\n        </DrawerOverlay>\n      </Drawer>\n    </>\n  );\n}\n","import { useEffect, useState } from 'react';\nimport {\n  Box,\n  Container,\n  Button,\n  Menu,\n  MenuButton,\n  MenuItem,\n  MenuList,\n  Divider,\n} from '@chakra-ui/react';\nimport { ChevronDownIcon } from '@chakra-ui/icons';\nimport { Route, useLocation, Switch, Redirect, useHistory } from 'react-router-dom';\n\nimport { useIsSmallerScreen } from '../utils/react';\nimport { CurrentCharacterContext } from '../store/character';\nimport { useStore } from '../store';\n\nimport NavLink from '../components/NavLink';\nimport CharacterBasic from '../components/Player/CharacterBasic';\nimport CharacterSkills from '../components/Player/CharacterSkills';\nimport CharacterSpellbook from '../components/Player/CharacterSpellbook';\n\nconst SIDEBAR_WIDTH = 140;\n\nconst NAV_LINKS = [\n  { text: '基本', url: '/player/basic' },\n  { text: '技能', url: '/player/skills' },\n  { text: '法术', url: '/player/spellbook' },\n];\n\nexport default function PlayerPage(): JSX.Element {\n  const store = useStore();\n  const [currentCharacter] = useState(() => store.characters[0]);\n  const showMenuNav = useIsSmallerScreen();\n  const [currentMenuNavItem, setCurrentMenuNavItem] = useState(NAV_LINKS[0]);\n  const location = useLocation();\n  const history = useHistory();\n\n  useEffect(() => {\n    const navLink = NAV_LINKS.find(({ url }) => url === location.pathname);\n\n    if (navLink) {\n      setCurrentMenuNavItem(navLink);\n    }\n  }, [location]);\n\n  return (\n    <CurrentCharacterContext.Provider value={currentCharacter}>\n      <Container\n        display={showMenuNav ? 'block' : 'flex'}\n        justifyContent=\"flex-start\"\n        alignItems=\"flex-start\"\n        pt=\"4\"\n      >\n        {showMenuNav ? (\n          <>\n            <Menu matchWidth autoSelect={false}>\n              <MenuButton\n                as={Button}\n                rightIcon={<ChevronDownIcon />}\n                variant=\"outline\"\n                width=\"100%\"\n                colorScheme=\"blackAlpha\"\n              >\n                {currentMenuNavItem.text}\n              </MenuButton>\n              <MenuList>\n                {NAV_LINKS.map((n) => (\n                  <MenuItem\n                    key={n.url}\n                    onClick={() => {\n                      history.push(n.url);\n                    }}\n                  >\n                    <NavLink to={n.url} fontSize=\"large\">\n                      {n.text}\n                    </NavLink>\n                  </MenuItem>\n                ))}\n              </MenuList>\n            </Menu>\n            <Divider my=\"2\" />\n          </>\n        ) : (\n          <Box width={SIDEBAR_WIDTH} borderRight=\"1px\" borderColor=\"gray.400\" flexShrink={0}>\n            {NAV_LINKS.map((n) => (\n              <Box key={n.url}>\n                <NavLink to={n.url} fontSize=\"large\">\n                  {n.text}\n                </NavLink>\n              </Box>\n            ))}\n          </Box>\n        )}\n        <Box pl={showMenuNav ? '0' : '4'} flexGrow={1}>\n          <Switch>\n            <Route path=\"/player/basic\" component={CharacterBasic} />\n            <Route path=\"/player/skills\" component={CharacterSkills} />\n            <Route path=\"/player/spellbook\" component={CharacterSpellbook} />\n\n            <Redirect to=\"/player/basic\" />\n          </Switch>\n        </Box>\n      </Container>\n    </CurrentCharacterContext.Provider>\n  );\n}\n","export function stringToColor(str: string): string {\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    hash = str.charCodeAt(i) + ((hash << 3) - hash);\n  }\n\n  let color = '#';\n  for (let i = 0; i < 3; i++) {\n    const value = (hash >> (i * 8)) & 0xff;\n    color += ('00' + value.toString(16)).substr(-2);\n  }\n\n  return color;\n}\n","import { Observer } from 'mobx-react-lite';\nimport {\n  Button,\n  ButtonGroup,\n  IconButton,\n  HStack,\n  Popover,\n  PopoverTrigger,\n  PopoverContent,\n  PopoverBody,\n  PopoverFooter,\n  Text,\n  Input,\n  Spacer,\n  Portal,\n} from '@chakra-ui/react';\nimport { FaPlus, FaMinus, FaUndo } from 'react-icons/fa';\n\nimport { useStore } from '../../store';\nimport { DMCharacter, Tracker as TrackerType } from '../../store/dm';\n\ninterface Props {\n  character: DMCharacter;\n}\n\nexport function Tracker({ tracker }: { tracker: TrackerType }): JSX.Element {\n  return (\n    <Observer>\n      {() => (\n        <HStack mb=\"2\">\n          <Input\n            variant=\"unstyled\"\n            value={tracker.name}\n            onChange={(e) => {\n              tracker.name = e.target.value;\n            }}\n          />\n          <Spacer />\n          <HStack>\n            <Text>{tracker.remain}</Text>\n            <Text>/</Text>\n            <Input\n              value={tracker.max}\n              px=\"0\"\n              width=\"2em\"\n              textAlign=\"center\"\n              onChange={(e) => {\n                tracker.max = e.target.value;\n              }}\n              size=\"sm\"\n              fontSize=\"1em\"\n            />\n          </HStack>\n          <ButtonGroup isAttached>\n            <IconButton\n              icon={<FaMinus />}\n              aria-label=\"decrease\"\n              size=\"sm\"\n              onClick={() => {\n                tracker.remain = Math.max(0, tracker.remain - 1);\n              }}\n              disabled={tracker.remain <= 0}\n            />\n            <IconButton\n              icon={<FaPlus />}\n              aria-label=\"increase\"\n              size=\"sm\"\n              onClick={() => {\n                tracker.remain = Math.min(parseInt(tracker.max), tracker.remain + 1);\n              }}\n              disabled={tracker.remain >= parseInt(tracker.max)}\n            />\n            <IconButton\n              icon={<FaUndo />}\n              aria-label=\"recover\"\n              size=\"sm\"\n              onClick={() => {\n                tracker.remain = parseInt(tracker.max);\n              }}\n              disabled={tracker.remain >= parseInt(tracker.max)}\n            />\n          </ButtonGroup>\n        </HStack>\n      )}\n    </Observer>\n  );\n}\n\nexport default function CharacterTracker({ character }: Props): JSX.Element {\n  const { dm } = useStore();\n\n  return (\n    <Popover placement=\"bottom-start\" isLazy>\n      <PopoverTrigger>\n        <Button size=\"sm\">\n          Trackers{character.trackers.length ? `(${character.trackers.length})` : ''}\n        </Button>\n      </PopoverTrigger>\n      <Portal>\n        <PopoverContent boxShadow=\"md\">\n          <Observer>\n            {() => (\n              <PopoverBody>\n                {character.trackers.length === 0 ? (\n                  <Text fontSize=\"lg\">暂无Tracker</Text>\n                ) : (\n                  character.trackers.map((t) => <Tracker key={t.id} tracker={t} />)\n                )}\n              </PopoverBody>\n            )}\n          </Observer>\n\n          <PopoverFooter d=\"flex\" justifyContent=\"flex-end\">\n            <Button size=\"sm\" onClick={() => dm.recoverTracker(character)} mr=\"2\">\n              全部恢复\n            </Button>\n            <Button size=\"sm\" onClick={() => dm.addTracker(character)}>\n              添加Tracker\n            </Button>\n          </PopoverFooter>\n        </PopoverContent>\n      </Portal>\n    </Popover>\n  );\n}\n","import { Observer } from 'mobx-react-lite';\nimport {\n  VStack,\n  HStack,\n  Input,\n  Box,\n  Text,\n  Button,\n  Menu,\n  MenuButton,\n  MenuList,\n  MenuItem,\n  Portal,\n} from '@chakra-ui/react';\n\nimport { useStore } from '../../store';\nimport { DMCharacter } from '../../store/dm';\nimport { stringToColor } from '../../utils/misc';\n\nimport CharacterTracker from './CharacterTracker';\n\ninterface Props {\n  character: DMCharacter;\n}\n\nexport default function Character({ character: c }: Props): JSX.Element {\n  const { dm } = useStore();\n\n  return (\n    <Observer>\n      {() => (\n        <VStack\n          border=\"1px\"\n          borderColor=\"gray.200\"\n          borderRadius=\"md\"\n          spacing={0}\n          opacity={parseInt(c.hp) <= 0 ? 0.6 : 1}\n        >\n          <HStack\n            borderBottom=\"1px\"\n            borderBottomColor=\"gray.200\"\n            borderTopWidth=\"6px\"\n            borderTopColor={stringToColor(c.name)}\n            borderTopRadius=\"md\"\n            alignItems=\"flex-end\"\n            p=\"2\"\n            pt=\"0\"\n            w=\"100%\"\n          >\n            <Box flexBasis=\"50%\">\n              <Text fontSize=\"xx-small\" color=\"gray.400\">\n                姓名\n              </Text>\n              <Input\n                value={c.name}\n                onChange={(e) => {\n                  c.name = e.target.value;\n                }}\n                variant=\"unstyled\"\n                fontSize=\"lg\"\n                fontWeight=\"bold\"\n              />\n            </Box>\n            <Box pt=\"1\">\n              <Text fontSize=\"xs\">\n                先攻: {parseInt(c.initiative) + c.rolledInitiative}({c.initiative} +{' '}\n                {c.rolledInitiative})\n              </Text>\n              <Text fontSize=\"xs\">\n                察觉: {parseInt(c.perception) + c.rolledPerception}({c.perception} +{' '}\n                {c.rolledPerception})\n              </Text>\n              <Text fontSize=\"xs\">\n                察言观色: {parseInt(c.senseMotive) + c.rolledSenseMotive}({c.senseMotive} +{' '}\n                {c.rolledSenseMotive})\n              </Text>\n              <Text fontSize=\"xs\">\n                意志: {parseInt(c.willSave) + c.rolledWillSave}({c.willSave} + {c.rolledWillSave})\n              </Text>\n            </Box>\n          </HStack>\n\n          <HStack spacing={0} borderBottom=\"1px\" borderColor=\"gray.200\">\n            <Box p=\"2\" borderRight=\"1px\" borderColor=\"gray.200\">\n              <Text fontSize=\"xx-small\" color=\"gray.400\">\n                HP\n              </Text>\n              <Input\n                value={c.hp}\n                onChange={(e) => {\n                  c.hp = e.target.value;\n                }}\n                variant=\"unstyled\"\n                type=\"number\"\n              />\n            </Box>\n            <Box p=\"2\" borderRight=\"1px\" borderColor=\"gray.200\">\n              <Text fontSize=\"xx-small\" color=\"gray.400\">\n                Max HP\n              </Text>\n              <Input\n                value={c.maxHP}\n                onChange={(e) => {\n                  c.maxHP = e.target.value;\n                }}\n                variant=\"unstyled\"\n                type=\"number\"\n              />\n            </Box>\n            <Box p=\"2\">\n              <Text fontSize=\"xx-small\" color=\"gray.400\">\n                消耗品同调\n              </Text>\n              <Input\n                value={c.attunement}\n                onChange={(e) => {\n                  c.attunement = e.target.value;\n                }}\n                variant=\"unstyled\"\n                type=\"number\"\n              />\n            </Box>\n          </HStack>\n          <HStack spacing={0} borderBottom=\"1px\" borderColor=\"gray.200\">\n            <Box p=\"2\" borderRight=\"1px\" borderColor=\"gray.200\">\n              <Text fontSize=\"xx-small\" color=\"gray.400\">\n                先攻加值\n              </Text>\n              <Input\n                value={c.initiative}\n                onChange={(e) => {\n                  c.initiative = e.target.value;\n                }}\n                variant=\"unstyled\"\n                type=\"number\"\n              />\n            </Box>\n            <Box p=\"2\" borderRight=\"1px\" borderColor=\"gray.200\">\n              <Text fontSize=\"xx-small\" color=\"gray.400\">\n                察觉加值\n              </Text>\n              <Input\n                value={c.perception}\n                onChange={(e) => {\n                  c.perception = e.target.value;\n                }}\n                variant=\"unstyled\"\n                type=\"number\"\n              />\n            </Box>\n            <Box p=\"2\" borderRight=\"1px\" borderColor=\"gray.200\">\n              <Text fontSize=\"xx-small\" color=\"gray.400\">\n                察言观色\n              </Text>\n              <Input\n                value={c.senseMotive}\n                onChange={(e) => {\n                  c.senseMotive = e.target.value;\n                }}\n                variant=\"unstyled\"\n                type=\"number\"\n              />\n            </Box>\n            <Box p=\"2\">\n              <Text fontSize=\"xx-small\" color=\"gray.400\">\n                意志豁免\n              </Text>\n              <Input\n                value={c.willSave}\n                onChange={(e) => {\n                  c.willSave = e.target.value;\n                }}\n                variant=\"unstyled\"\n                type=\"number\"\n              />\n            </Box>\n          </HStack>\n          <HStack p=\"2\" justify=\"flex-start\" align=\"center\" w=\"full\">\n            <CharacterTracker character={c} />\n            <Menu isLazy>\n              <MenuButton as={Button} size=\"sm\">\n                投\n              </MenuButton>\n              <Portal>\n                <MenuList>\n                  <MenuItem onClick={() => dm.rollInitiative(c)}>先攻</MenuItem>\n                  <MenuItem onClick={() => dm.rollPerception(c)}>察觉</MenuItem>\n                  <MenuItem onClick={() => dm.rollWillSave(c)}>意志</MenuItem>\n                </MenuList>\n              </Portal>\n            </Menu>\n\n            <Button size=\"sm\" onClick={() => dm.heal(c)}>\n              恢复\n            </Button>\n            <Button\n              colorScheme=\"red\"\n              size=\"sm\"\n              onClick={() => {\n                if (confirm('确定移除此人物?')) {\n                  dm.removeCharacter(c);\n                }\n              }}\n            >\n              删除\n            </Button>\n          </HStack>\n        </VStack>\n      )}\n    </Observer>\n  );\n}\n","import { Button, ButtonGroup } from '@chakra-ui/react';\n\ninterface Props<T> {\n  options: Array<{ text: string; value: T; key?: string }>;\n  value: T;\n  onChange: (v: T) => void;\n}\n\nexport default function ButtonSwitch<T = string>({\n  options,\n  value,\n  onChange,\n}: Props<T>): JSX.Element {\n  return (\n    <ButtonGroup isAttached>\n      {options.map(({ text, value: v, key }, i) => (\n        <Button\n          key={key ?? i}\n          onClick={() => onChange(v)}\n          colorScheme={value === v ? 'teal' : 'gray'}\n        >\n          {text}\n        </Button>\n      ))}\n    </ButtonGroup>\n  );\n}\n","import { useState } from 'react';\nimport { Observer } from 'mobx-react-lite';\nimport {\n  Button,\n  ButtonGroup,\n  IconButton,\n  Menu,\n  MenuButton,\n  MenuList,\n  MenuItem,\n  Container,\n  SimpleGrid,\n  HStack,\n  Spacer,\n} from '@chakra-ui/react';\nimport { FaChevronDown } from 'react-icons/fa';\n\nimport { useStore } from '../store';\nimport { useIsSmallerScreen } from '../utils/react';\n\nimport DMCharacter from '../components/DM/Character';\nimport ButtonSwitch from '../components/ButtonSwitch';\n\nexport default function DMPage(): JSX.Element {\n  const { dm } = useStore();\n  const [order, setOrder] = useState('normal');\n  const isSmallerScreen = useIsSmallerScreen();\n\n  return (\n    <Container pt=\"2\">\n      <HStack w=\"full\" wrap=\"wrap\" spacing={[0, 2]}>\n        <Button\n          mb={[2, 0]}\n          mr={[2, 0]}\n          onClick={() => {\n            dm.addCharacter('无名氏');\n          }}\n        >\n          添加人物\n        </Button>\n        <Button\n          mb={[2, 0]}\n          onClick={() => {\n            dm.addCharacter('敌人');\n          }}\n        >\n          添加敌人\n        </Button>\n        <Spacer />\n        <ButtonGroup isAttached mb={[2, 0]}>\n          <Button onClick={() => dm.rollAllInitiative()}>全员投先攻</Button>\n          <Menu placement=\"bottom-end\">\n            <MenuButton as={IconButton} icon={<FaChevronDown />} aria-label=\"More Action\" />\n            <MenuList>\n              <MenuItem onClick={() => dm.rollAllPerception()}>全员投察觉</MenuItem>\n              <MenuItem onClick={() => dm.rollAllSenseMotive()}>全员投察言观色</MenuItem>\n              <MenuItem onClick={() => dm.rollAllWillSave()}>全员投意志</MenuItem>\n              <MenuItem onClick={() => dm.healAll()}>全员恢复</MenuItem>\n              <MenuItem onClick={() => dm.recoverAllTracker()}>全员恢复Tracker</MenuItem>\n              <MenuItem onClick={() => dm.recoverAllAttunment()}>全员恢复消耗品同调</MenuItem>\n            </MenuList>\n          </Menu>\n        </ButtonGroup>\n        <ButtonSwitch\n          options={[\n            { text: '创建顺序', value: 'normal' },\n            { text: '先攻顺序', value: 'initiative' },\n          ]}\n          value={order}\n          onChange={(v) => setOrder(v)}\n        />\n      </HStack>\n\n      <Observer>\n        {() => (\n          <SimpleGrid py=\"2\" spacing=\"2\" columns={isSmallerScreen ? 1 : 3}>\n            {(order === 'initiative' ? dm.sortedCharacters : dm.characters).map((c) => (\n              <DMCharacter key={c.id} character={c} />\n            ))}\n          </SimpleGrid>\n        )}\n      </Observer>\n    </Container>\n  );\n}\n","import { BrowserRouter as Router, Route, Switch, Redirect } from 'react-router-dom';\nimport { Box } from '@chakra-ui/react';\n\nimport Navbar from './components/Navbar';\nimport PlayerPage from './pages/PlayerPage';\nimport DMPage from './pages/DMPage';\n\nfunction App(): JSX.Element {\n  return (\n    <Router basename={process.env.NODE_ENV === 'development' ? '/' : '/pathfinder-workbench'}>\n      <Box>\n        <Navbar />\n\n        <Box>\n          <Switch>\n            <Route path=\"/player\" component={PlayerPage} />\n            <Route path=\"/dm\" component={DMPage} />\n\n            <Redirect to=\"/player\" />\n          </Switch>\n        </Box>\n      </Box>\n    </Router>\n  );\n}\n\nexport default App;\n","/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\n\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://cra.link/PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://cra.link/PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { ChakraProvider, extendTheme } from '@chakra-ui/react';\nimport { configure } from 'mobx';\n\nimport { CONTAINER_WIDTH } from './constant';\nimport { StoreContext, Store } from './store';\n\nimport App from './App';\nimport * as serviceWorkerRegistration from './serviceWorkerRegistration';\n\nconfigure({ enforceActions: 'never' });\n\nconst theme = extendTheme({\n  components: {\n    Container: {\n      baseStyle: {\n        maxW: CONTAINER_WIDTH,\n      },\n    },\n  },\n});\n\nconst store = new Store();\n\nasync function init() {\n  await store.init();\n\n  ReactDOM.render(\n    <React.StrictMode>\n      <ChakraProvider theme={theme}>\n        <StoreContext.Provider value={store}>\n          <App />\n        </StoreContext.Provider>\n      </ChakraProvider>\n    </React.StrictMode>,\n    document.getElementById('root')\n  );\n}\n\ninit();\n\nlet refreshing = false;\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://cra.link/PWA\nserviceWorkerRegistration.register({\n  onUpdate: (registration) => {\n    if (confirm('New version found, update?')) {\n      navigator.serviceWorker.addEventListener('controllerchange', () => {\n        if (refreshing) {\n          return;\n        }\n\n        refreshing = true;\n        window.location.reload();\n      });\n\n      registration.waiting?.postMessage({ type: 'SKIP_WAITING' });\n    }\n  },\n});\n"],"sourceRoot":""}